/*
 This file is part of WordyWordy.

 WordyWordy is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 WordyWordy is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with WordyWordy.  If not, see <http://www.gnu.org/licenses/>.
*/

/*!
* screenfull
* v3.2.0 - 2017-04-16
* (c) Sindre Sorhus; MIT License
*/

define("utl/formatting",[],function(){"use strict";function e(e){var t=e/n,r=Math.max(0,t/o),s=Math.max(0,r/i),c=Math.max(0,s/a),l=Math.max(0,e-Math.floor(t)*n);return t=Math.max(0,t-Math.floor(r)*o),r=Math.max(0,r-Math.floor(s)*i),s=Math.max(0,s-Math.floor(c)*a),{days:Math.floor(c),hours:Math.floor(s),minutes:Math.floor(r),seconds:Math.floor(t),milliseconds:l}}function t(e){return e<10?"0"+e:e.toString()}var n=1e3,o=60,i=60,a=24;return{formatTime:function(n,o){var i=e(n);return o||(o=!1),(i.hours>0?i.hours+":":"")+t(i.minutes)+":"+t(i.seconds)+(o?"."+i.milliseconds:"")},sanitizeNumber:function(e,t){return"string"==typeof e&&(e=parseInt(e,10)),("number"!=typeof e||isNaN(e))&&(e=t),e},sanitizeBooleanesque:function(e){return["1","true","y","yes"].indexOf(e)>-1}}}),define("utl/paramslikker",[],function(){"use strict";return{getParams:function(e){var t={};if(e){var n=[];e.slice(1).split("&").forEach(function(e){n=e.split("="),2===n.length&&(t[n[0]]=unescape(n[1]))})}return t}}}),define("utl/browserutl",[],function(){"use strict";return{ajax:function(e,t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(e){4!==e.target.readyState||e.target.status&&200!==e.target.status?n(e):t(e)},o.open("GET",e),o.responseType="text",o.send()},localStorageOK:function(){return"undefined"!=typeof localStorage},hasTextMime:function(e){return e.contains("text/plain")}}}),define("utl/gaga",[],function(){"use strict";var e=!0;return{gaSetup:function(t){e=t,window["ga-disable-UA-78467679-1"]=!e},g:function(t,n,o,i,a,r){!0===e&&Boolean(window.ga)&&ga.loaded&&ga(t,n,o,i,a,r)}}}),define("chopper/constants",[],function(){var e=".?!。？",t="⺀-⺙|⺛-⻳|⼀-⿕|々|〇|〡-〩|〸-〺|〻|㐀-䶵|一-鿌|豈-舘|並-龎",n="ꀀ-ꀔ|ꀕ|ꀖ-ꒌ|꒐-꓆",o="ᄀ-ᇿ|〮-〯|ㄱ-ㆎ|㈀-㈞|㉠-㉾|ꥠ-ꥼ|가-힣|ힰ-ퟆ|ퟋ-ퟻ|ﾠ-ﾾ|ￂ-ￇ|ￊ-ￏ|ￒ-ￗ|ￚ-ￜ",i=t+"|"+n+"|"+o;return{SPACES_RE:new RegExp("[ \f\n\r\t\v ᠎           \u2028\u2029  　]+"),SENTENCE_END_RE:new RegExp("["+e+"]"),PARAGRAPH_END_RE:new RegExp(" "),CJK_RE:new RegExp("(["+i+"])","g"),MILLISECONDS_PER_MINUTE:6e4}}),define("chopper/tokenizer",["./constants"],function(e){return{tokenize:function(t){return t=t||"",t.replace(/[-]{4,}/g,"---").replace(/[_]{4,}/g,"___").replace(/[=]{4,}/g,"===").replace(/[+]{4,}/g,"+++").replace(/[~]{4,}/g,"~~~").replace(/\.\.\./g,"…").replace(/([a-zA-Z]{2,})([()[\]{}.?!:;\-,\u2026\/|\u2010-\u2015]{1,2})([a-zA-Z]{2,})/g,"$1$2 $3").replace(/&nbsp;/g," ").replace(/\u00A0/g," ").replace(/\r\n/g,"\n").replace(/[\n]{2,}/g,"  ").replace(e.CJK_RE," $1").split(e.SPACES_RE)}}}),define("chopper/gear",["../utl/formatting","./constants"],function(e,t){function n(t){t=e.sanitizeNumber(t,c),v=Math.min(l,Math.max(s,t)),o(a(t))}function o(e){T=u*e,y=d*e,x=[{re:t.SENTENCE_END_RE,delay:h*e},{re:/[;:\u2026\u2013\u00B7|\u2010-\u2015]/,delay:w*e},{re:/[-,\/\uFF0C]/,delay:m*e},{re:/[()[]{}]/,delay:E*e},{re:/["'\u2018\u2019\u201c\u201d]/,delay:_*e},{re:/\u00A0/,delay:S*e},{re:/[0-9=+]/,delay:p*e},{re:/[A-Z]/,delay:g*e},{re:t.CJK_RE,delay:f*e}]}function i(e){var t=x.filter(function(t){return t.re.test(e)});return t.length>0?t[0].delay:y}function a(e){return t.MILLISECONDS_PER_MINUTE/e/300}function r(e){return e?e.split("").reduce(function(e,t){return e+i(t)},T):0}var s=60,c=300,l=600,u=100,d=30,f=250,p=50,g=50,_=40,E=100,m=180,w=250,h=400,S=250,v=c,T=u*a(v),y=d*a(v),x=[];return{setSpeed:n,getSpeed:function(){return v},incSpeed:function(e){n(v+e)},decSpeed:function(e){n(v-e)},determineDisplayTime:r}}),define("chopper/navigator",["../utl/formatting","./constants"],function(e,t){function n(e){c=Math.min(s.length,Math.max(0,e))}function o(e){n(c+e)}function i(e){n(c-e)}function a(e){var t=!1,n=Math.min(c+r,s.length);for(c;!t&&c<n;c++)s[c]&&s[c].match(e)&&(t=!0)}var r=69,s=[],c=0;return{init:function(t,o){s=t,n(e.sanitizeNumber(o,0))},setPosition:n,incPosition:o,decPosition:i,getCurrentWord:function(){return s[c]},getLength:function(){return s.length},getPercentage:function(){return s.length>0?100*(c/s.length):0},getPosition:function(){return c},gotoEndOfSentence:function(){var e=!1,n=Math.min(c+r,s.length);for(c;!e&&c<n;c++)s[c]&&s[c].match(t.SENTENCE_END_RE)&&(e=!0,c-=1)},gotoStartOfSentence:function(){var e=!1;s[c-1]&&s[c-1].match(t.SENTENCE_END_RE)&&i(1),s[c]&&s[c].match(t.SENTENCE_END_RE)&&i(1);var n=Math.max(c-r,0);for(c;!e&&c>n;c--)s[c]&&s[c].match(t.SENTENCE_END_RE)&&(e=!0,c+=2);Boolean(s[c])&&s[c].match(t.PARAGRAPH_END_RE)&&o(1)},gotoStartOfNextSentence:function(){a(t.SENTENCE_END_RE)},gotoStartOfNextParagraph:function(){a(t.PARAGRAPH_END_RE)}}}),define("chopper/chopper",["./tokenizer","./gear","./navigator","./constants"],function(e,t,n,o){"use strict";var i=[];return{init:function(t,o){i=e.tokenize(t),n.init(i,o)},getSpeed:t.getSpeed,setSpeed:t.setSpeed,incSpeed:t.incSpeed,decSpeed:t.decSpeed,getCurrentWord:n.getCurrentWord,getLength:n.getLength,getPercentage:n.getPercentage,getPosition:n.getPosition,setPosition:n.setPosition,incPosition:n.incPosition,decPosition:n.decPosition,gotoEndOfSentence:n.gotoEndOfSentence,gotoStartOfSentence:n.gotoStartOfSentence,gotoStartOfNextSentence:n.gotoStartOfNextSentence,gotoStartOfNextParagraph:n.gotoStartOfNextParagraph,getDisplayTime:function(){return t.determineDisplayTime(n.getCurrentWord())},getEstimatedTimeToGo:function(){return o.MILLISECONDS_PER_MINUTE*(n.getLength()-n.getPosition())/t.getSpeed()},getAverageSpeed:function(){var e=i.reduce(function(e,n){return e+t.determineDisplayTime(n)},0);return i.length/(e/o.MILLISECONDS_PER_MINUTE)}}}),define("utl/stopwatch",[],function(){"use strict";function e(){this.reset()}return e.prototype.reset=function(){this.state="paused",this.startTime=Date.now(),this.pauseStartTime=this.startTime,this.cumulativePauses=0},e.prototype.start=function(){this.state="running",this.startTime=Date.now(),this.pauseStartTime=this.startTime,this.cumulativePauses=0},e.prototype.resume=function(){this.state="running";var e=Date.now()-this.pauseStartTime;this.cumulativePauses+=e},e.prototype.pause=function(){"paused"!==this.state&&(this.state="paused",this.pauseStartTime=Date.now())},e.prototype.getTimeElapsed=function(){return"running"===this.state?Date.now()-this.startTime-this.cumulativePauses:this.pauseStartTime-this.startTime-this.cumulativePauses},{Stopwatch:e}}),define("ui-control/constants",[],function(){"use strict";return{LS_KEY_BUFFER:"buffer",LS_KEY_TITLE:"title",LS_KEY_POSITION:"position",LS_KEY_SPEED:"speed",LS_KEY_THEME:"theme"}}),define("ui-control/themeswitcher",["../utl/formatting"],function(e){"use strict";function t(){i++,i>=a.length&&(i=0),n(i)}function n(t){i=Math.max(Math.min(e.sanitizeNumber(t,1),a.length-1),0),window.customtheme.href=a[i].href}function o(){return a[i]}var i=1,a=[{nr:0,title:"Zany",href:"style/themes/zany.css"},{nr:1,title:"Sepia",href:"style/themes/sepia.css"},{nr:2,title:"Day",href:"style/themes/day.css"},{nr:3,title:"Night",href:"style/themes/night.css"},{nr:4,title:"Low contrast",href:"style/themes/low-contrast.css"},{nr:5,title:"High contrast",href:"style/themes/high-contrast.css"},{nr:6,title:"Dyslexia - sepia",href:"style/themes/dyslexia-sepia.css"},{nr:7,title:"Dyslexia - day",href:"style/themes/dyslexia-day.css"},{nr:8,title:"Dyslexia - night",href:"style/themes/dyslexia-night.css"},{nr:9,title:"Dyslexia - low contrast",href:"style/themes/dyslexia-low-contrast.css"},{nr:10,title:"Dyslexia - high contrast",href:"style/themes/dyslexia-high-contrast.css"},{nr:11,title:"Low contrast fat font",href:"style/themes/low-contrast-fat-font.css"},{nr:12,title:"Sepia fat font",href:"style/themes/sepia-fat-font.css"},{nr:13,title:"Night fat font",href:"style/themes/night-fat-font.css"},{nr:14,title:"220",href:"style/themes/220.css"},{nr:15,title:"057",href:"style/themes/057.css"},{nr:16,title:"074",href:"style/themes/074.css"},{nr:17,title:"HV",href:"style/themes/hv.css"},{nr:18,title:"liberal",href:"style/themes/liberal.css"},{nr:19,title:"progressive",href:"style/themes/progressive.css"},{nr:20,title:"Fountain Pen",href:"style/themes/fountainpen.css"},{nr:21,title:"background",href:"style/themes/background.css"}];return{cycleTheme:t,setTheme:n,getCurrentTheme:o}}),function(){"use strict";var e="undefined"==typeof window?{}:window.document,t="undefined"!=typeof module&&module.exports,n="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,o=function(){for(var t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],o=0,i=n.length,a={};o<i;o++)if(t=n[o],t&&t[1]in e){for(o=0;o<t.length;o++)a[n[0][o]]=t[o];return a}return!1}(),i={request:function(t){var i=o.requestFullscreen;t=t||e.documentElement,/5\.1[.\d]* Safari/.test(navigator.userAgent)?t[i]():t[i](n&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){e[o.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(t){e.addEventListener(o.fullscreenchange,t,!1)},onerror:function(t){e.addEventListener(o.fullscreenerror,t,!1)},raw:o};return o?(Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(e[o.fullscreenElement])}},element:{enumerable:!0,get:function(){return e[o.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(e[o.fullscreenEnabled])}}}),void(t?module.exports=i:window.screenfull=i)):void(t?module.exports=!1:window.screenfull=!1)}(),define("ui-control/../../lib/screenfull",function(){}),define("ui-control/actions",["../chopper/chopper","../utl/formatting","../utl/stopwatch","../utl/browserutl","../utl/gaga","../ui-control/constants","../ui-control/themeswitcher","../../lib/screenfull"],function(e,t,n,o,i,a,r){"use strict";function s(){X&&window.clearTimeout(X),J===!0&&(window.__output.className="playing"),G&&(e.getPosition()<e.getLength()?(X=window.setTimeout(s,e.getDisplayTime()),c(e.getCurrentWord(),!0),e.incPosition(1)):J===!0?(e.setPosition(0),window.__output.className="reload",X=window.setTimeout(s,1e3)):(window.__output.textContent="",window.__output.className="smile",f()))}function c(t,n){void 0!==t&&(window.__output.textContent=t,window.__percentage.setAttribute("style","width: "+e.getPercentage()+"%;"),$&&l(),n&&q++)}function l(){var n=re.getTimeElapsed(),o=n/ie,i=o>0?q/o:0,a=e.getEstimatedTimeToGo(),r=n+a;window.__documentTitle.textContent=Q,window.__selectedSpeed.textContent=e.getSpeed().toFixed(0),window.__actualSpeed.textContent=i.toFixed(0),window.__position.textContent=e.getPosition(),window.__positionInPercent.textContent=e.getPercentage().toFixed(1),window.__wordsPlayed.textContent=q,window.__wordsTotal.textContent=e.getLength(),window.__timeElapsed.textContent=t.formatTime(n),window.__timeToGo.textContent=t.formatTime(a),window.__timeTotal.textContent=t.formatTime(r)}function u(){$=!$,$?(window.__status.style.display="inline",l()):window.__status.style.display="none",i.g("send","event","app","status-toggle")}function d(){re.resume(),G=!0,window.__output.className="playing",window.__btn_playpause.className=oe,document.title=te+" "+Q+" - "+ee,s()}function f(){re.pause(),G=!1,document.title=Q+" - "+ee,window.__btn_playpause.className=ne,o.localStorageOK()&&localStorage.setItem("position",e.getPosition())}function p(){Z&&window.clearTimeout(Z),window.__controls.className="",window.__actionbar.className="",Z=window.setTimeout(function(){window.__controls.className="fade-away",window.__actionbar.className="fade-away"},ae)}function g(e){V&&window.clearTimeout(V),window.__toast.style.display="block",window.__toast.className="",window.__toast.innerHTML=e,V=window.setTimeout(function(){window.__toast.className="fade-away"},ae)}function _(e){Q=e,o.localStorageOK()&&localStorage.setItem(a.LS_KEY_TITLE,e)}function E(t){t&&f(),c(e.getCurrentWord(),!1),g(e.getPercentage().toFixed(1)+"%")}function m(e){l(),g(e.toFixed(0)+" wpm"),o.localStorageOK()&&localStorage.setItem(a.LS_KEY_SPEED,e)}function w(){g("<span class='icon-stopwatch'></span> -"+t.formatTime(e.getEstimatedTimeToGo()))}function h(){r.cycleTheme(),g(r.getCurrentTheme().title),o.localStorageOK()&&localStorage.setItem(a.LS_KEY_THEME,r.getCurrentTheme().nr),i.g("send","event","app","theme-cycle")}function S(e){r.setTheme(e),g(r.getCurrentTheme().title),o.localStorageOK()&&localStorage.setItem(a.LS_KEY_THEME,r.getCurrentTheme().nr),i.g("send","event","app","theme-set")}function v(){E(!0),window.__input_file.click()}function T(t){e.setPosition(t),E(!1)}function y(t){T(Math.floor(t*e.getLength())),i.g("send","event","app","position-fraction")}function x(){T(0),i.g("send","event","app","position-home")}function K(t){e.decPosition(1),E(!0),t||i.g("send","event","app","position-previous-word")}function N(){G=!G,G?d():f(),i.g("send","event","app","play-pause")}function Y(t){e.incPosition(1),E(!0),t||i.g("send","event","app","position-next-word")}function L(){T(e.getLength()),i.g("send","event","app","position-end")}function P(){e.incSpeed(5),m(e.getSpeed()),i.g("send","event","app","speed-up")}function O(){e.decSpeed(5),m(e.getSpeed()),i.g("send","event","app","speed-slow-down")}function D(t){e.setSpeed(t),m(e.getSpeed()),i.g("send","event","app","speed-set")}function F(t){e.setSpeedFraction(t),m(e.getSpeed()),i.g("send","event","app","speed-set-fraction")}function b(){e.gotoStartOfNextSentence(),E(!1),i.g("send","event","app","position-start-of-next-sentence")}function C(){e.gotoStartOfNextParagraph(),E(!1),i.g("send","event","app","position-start-of-next-paragraph")}function I(){e.gotoStartOfSentence(),E(!0),i.g("send","event","app","position-start-of-sentence")}function R(){o.localStorageOK()&&localStorage.setItem(a.LS_KEY_POSITION,e.getPosition()),g("position saved"),i.g("send","event","app","position-save")}function M(t,n){q=0,window.__output.className="",o.localStorageOK()&&localStorage.setItem(a.LS_KEY_BUFFER,t),e.init(t),window.__avgSpeed.textContent=e.getAverageSpeed().toFixed(1),re.reset(),c(e.getCurrentWord(),!1),w(),_(n)}function k(e){J=e}function A(){M("",""),o.localStorageOK()&&(localStorage.removeItem(a.LS_KEY_BUFFER),localStorage.removeItem(a.LS_KEY_TITLE),localStorage.removeItem(a.LS_KEY_POSITION),localStorage.removeItem(a.LS_KEY_SPEED),localStorage.removeItem(a.LS_KEY_THEME)),x(),g("Forgot everything"),i.g("send","event","app","forget-everything")}function z(){window.screenfull.enabled&&window.screenfull.toggle(),i.g("send","event","app","toggle-fullscreen")}function U(){j||p()}function H(){Z&&window.clearTimeout(Z),j=!0,window.__controls.className="",window.__actionbar.className=""}function W(){j=!1}function B(){return Q}var G=!1,q=0,X=null,V=null,Z=null,j=!1,$=!1,J=!1,Q="",ee="WordyWordy",te="▷",ne="icon-play3",oe="icon-pause2",ie=6e4,ae=2200,re=new n.Stopwatch;return{toggleStatus:u,play:d,pause:f,toast:g,showTimeToGo:w,setTheme:S,cycleTheme:h,openFile:v,setPos:T,setPosFraction:y,home:x,end:L,dec:K,playpause:N,inc:Y,speedUp:P,slowDown:O,setSpeed:D,setSpeedFraction:F,gotoStartOfNextSentence:b,gotoStartOfNextParagraph:C,gotoStartOfSentence:I,savePosition:R,initiateText:M,setLooping:k,forgetEverything:A,toggleFullscreen:z,mousemove:U,controlsMouseover:H,controlsMouseout:W,getDocumentTitle:B,setDocumentTitle:_}}),define("ui-control/eventmap",["./actions","../utl/browserutl","../utl/gaga"],function(e,t,n){"use strict";function o(t){t&&t.clipboardData&&(e.initiateText(t.clipboardData.getData("text/plain"),"clipboard"),e.play()),t.preventDefault(),n.g("send","event","app","source-paste")}function i(e){e.preventDefault()}function a(e){e.preventDefault()}function r(e){e.preventDefault(),window.__output.className=""}function s(e){e.preventDefault()}function c(e){e.preventDefault(),window.__output.className="smile"}function l(e){e.preventDefault(),window.__output.className=""}function u(t){e.setPosFraction(t.clientX/window.__percentagewrap.scrollWidth)}function d(e){T[v[e.keyCode]]&&(void 0===T[v[e.keyCode]].arg?T[v[e.keyCode]].func():T[v[e.keyCode]].func(T[v[e.keyCode]].arg)),window.__droparea.value=""}function f(t){t.preventDefault(),t.deltaY?t.deltaY>0?e.inc(!0):t.deltaY<0&&e.dec(!0):t.deltaX&&0!==t.deltaX&&0===t.deltaY&&(t.deltaX>0?e.dec(!0):t.deltaX<0&&e.inc(!0))}function p(t){t&&t.target&&t.target.result&&(e.initiateText(t.target.result,x),e.play(),n.g("send","event","app","source-file-open-success"))}function g(e){if(e.target.files.length>0){var t=e.target.files[0];"text/plain"===t.type?(y.readAsText(t),x=t.name,n.g("send","event","app","source-file-open")):n.g("send","exception",{exDescription:"source-file-open-not-plain-text",exFatal:!1})}else n.g("send","exception",{exDescription:"source-file-open-no-files",exFatal:!1})}function _(o){if(window.__output.className="playing",o.dataTransfer.files.length>0){var i=o.dataTransfer.files[0];"text/plain"===i.type?(y.readAsText(i),x=i.name,n.g("send","event","app","source-file-open-drop")):n.g("send","exception",{exDescription:"source-file-open-drop-not-plain-text",exFatal:!1})}else t.hasTextMime(o.dataTransfer.types)&&(e.initiateText(o.dataTransfer.getData("text/plain"),"drag/ drop"),e.play(),n.g("send","event","app","source-text-drop"));o.preventDefault()}function E(){window.__droparea.addEventListener("drag",i,!0),window.__droparea.addEventListener("dragenter",a,!0),window.__droparea.addEventListener("dragleave",r,!0),window.__droparea.addEventListener("dragstart",s,!0),window.__droparea.addEventListener("dragover",c,!0),window.__droparea.addEventListener("dragend",l,!0),window.__droparea.addEventListener("paste",o,!0),window.__droparea.addEventListener("drop",_,!0)}function m(){window.__btn_home.addEventListener("click",e.gotoStartOfSentence,!0),window.__btn_dec.addEventListener("click",function(){e.dec(!1)},!0),window.__btn_playpause.addEventListener("click",e.playpause,!1),window.__btn_inc.addEventListener("click",function(){e.inc(!1)},!0),window.__btn_end.addEventListener("click",e.gotoStartOfNextSentence,!0),window.__btn_paragraph.addEventListener("click",e.gotoStartOfNextParagraph,!0)}function w(){window.__input_file.addEventListener("change",g,!0),window.__btn_open.addEventListener("click",e.openFile,!0),window.__btn_theme.addEventListener("click",e.cycleTheme,!0),window.__btn_slowdown.addEventListener("click",e.slowDown,!0),window.__btn_speedup.addEventListener("click",e.speedUp,!0),window.__btn_fullscreen.addEventListener("click",e.toggleFullscreen,!0),window.__btn_info.addEventListener("click",e.toggleStatus,!0),window.__lnk_more_information.addEventListener("click",function(e){n.g("send","event","Outbound link",null,e.target.href)},!0)}function h(){window.document.body.addEventListener("wheel",f,!0),window.document.body.addEventListener("mousemove",e.mousemove,!0),window.__controls.addEventListener("mouseover",e.controlsMouseover,!0),window.__controls.addEventListener("mouseout",e.controlsMouseout,!0),window.__actionbar.addEventListener("mouseover",e.controlsMouseover,!0),window.__actionbar.addEventListener("mouseout",e.controlsMouseout,!0)}function S(){E(),m(),w(),window.__percentagewrap.addEventListener("click",u,!0),window.__rightarea.addEventListener("click",e.playpause,!0),window.document.body.addEventListener("keydown",d,!0),h()}var v={0:"SECTION_KEY_FF",9:"TAB_KEY",13:"ENTER_KEY",188:"COMMA_KEY",190:"DOT_KEY",191:"SLASH_KEY",192:"SECTION_KEY",32:"SPACE_KEY",33:"PAGEUP_KEY",34:"PAGEDOWN_KEY",35:"END_KEY",36:"HOME_KEY",37:"LEFT_KEY",38:"UP_KEY",39:"RIGHT_KEY",40:"DOWN_KEY",48:"ZERO_KEY",49:"ONE_KEY",50:"TWO_KEY",51:"THREE_KEY",52:"FOUR_KEY",53:"FIVE_KEY",54:"SIX_KEY",55:"SEVEN_KEY",56:"EIGHT_KEY",57:"NINE_KEY",65:"A_KEY",66:"B_KEY",67:"C_KEY",68:"D_KEY",69:"E_KEY",70:"F_KEY",73:"I_KEY",79:"O_KEY",81:"Q_KEY",82:"R_KEY",83:"S_KEY",84:"T_KEY",87:"W_KEY"},T={HOME_KEY:{func:e.home},END_KEY:{func:e.end},I_KEY:{func:e.toggleStatus},C_KEY:{func:e.forgetEverything},T_KEY:{func:function(){e.showTimeToGo(),n.g("send","event","app","time-to-go-show")}},SPACE_KEY:{func:e.playpause},ENTER_KEY:{func:e.playpause},LEFT_KEY:{func:e.dec},A_KEY:{func:e.dec},PAGEDOWN_KEY:{func:e.gotoStartOfNextSentence},E_KEY:{func:e.gotoStartOfNextSentence},R_KEY:{func:e.gotoStartOfNextParagraph},RIGHT_KEY:{func:e.inc},D_KEY:{func:e.inc},PAGEUP_KEY:{func:e.gotoStartOfSentence},Q_KEY:{func:e.gotoStartOfSentence},DOWN_KEY:{func:e.slowDown},S_KEY:{func:e.slowDown},UP_KEY:{func:e.speedUp},W_KEY:{func:e.speedUp},O_KEY:{func:e.openFile},B_KEY:{func:e.savePosition},F_KEY:{func:e.toggleFullscreen},ONE_KEY:{func:e.setTheme,arg:1},TWO_KEY:{func:e.setTheme,arg:2},THREE_KEY:{func:e.setTheme,arg:3},FOUR_KEY:{func:e.setTheme,arg:4},FIVE_KEY:{func:e.setTheme,arg:5},SIX_KEY:{func:e.setTheme,arg:6},SEVEN_KEY:{func:e.setTheme,arg:7},EIGHT_KEY:{func:e.setTheme,arg:8},NINE_KEY:{func:e.setTheme,arg:9},SECTION_KEY:{func:e.cycleTheme},SECTION_KEY_FF:{func:e.cycleTheme}},y=new FileReader,x="";return y.addEventListener("loadend",p),{addEventListeners:S}}),require(["utl/formatting","utl/paramslikker","utl/browserutl","utl/gaga","ui-control/eventmap","ui-control/actions","ui-control/constants"],function(e,t,n,o,i,a,r){"use strict";function s(e){o.gaSetup(!e),o.g("create","UA-78467679-1","auto"),o.g("send","pageview")}function c(t){s(e.sanitizeBooleanesque(t.donottrack)),t.speed&&a.setSpeed(t.speed),t.theme&&a.setTheme(t.theme),t.text&&a.initiateText(decodeURIComponent(t.text),"url"),t.pos&&a.setPos(t.pos),t.loop&&e.sanitizeBooleanesque(t.loop)?a.setLooping(!0):a.setLooping(!1),t.play&&e.sanitizeBooleanesque(t.play)&&window.setTimeout(a.play,d),!t.text&&t.canned&&n.ajax(decodeURIComponent(f[t.canned]),function(e){a.initiateText(e.target.response,t.canned)},function(){o.g("send","exception",{exDescription:"could-not-load-canned-text "+t.canned,exFatal:!1})}),!t.text&&t.url&&n.ajax(decodeURIComponent(t.url),function(e){a.initiateText(e.target.response,t.url)},function(){o.g("send","exception",{exDescription:"could-not-load-text-from-url "+t.url,exFatal:!1})})}function l(e,t,n){localStorage.getItem(e)&&t(localStorage.getItem(e),n)}function u(){n.localStorageOK()&&(l(r.LS_KEY_SPEED,a.setSpeed),l(r.LS_KEY_TITLE,a.setDocumentTitle),l(r.LS_KEY_BUFFER,a.initiateText,a.getDocumentTitle()),l(r.LS_KEY_POSITION,a.setPos),l(r.LS_KEY_THEME,a.setTheme))}var d=1e3,f={thoughts:"samples/thoughts.txt",1984:"samples/1984.txt",freedom:"samples/freedom.txt",intro:"samples/intro.txt",intro_nl:"samples/intro.nl.txt",laozi:"samples/laozi.txt"};i.addEventListeners(),u(),c(t.getParams(window.location.search))}),define("wordywordy",function(){});
